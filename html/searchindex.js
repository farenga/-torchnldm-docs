Search.setIndex({"docnames": ["index", "modules", "setup", "torchnldm", "torchnldm.data", "torchnldm.evaluate", "torchnldm.model", "torchnldm.train", "torchnldm.utils"], "filenames": ["index.rst", "modules.rst", "setup.rst", "torchnldm.rst", "torchnldm.data.rst", "torchnldm.evaluate.rst", "torchnldm.model.rst", "torchnldm.train.rst", "torchnldm.utils.rst"], "titles": ["TorchNLDM documentation", "torchnldm", "setup module", "torchnldm package", "torchnldm.data package", "torchnldm.evaluate package", "torchnldm.model package", "torchnldm.train package", "torchnldm.utils package"], "terms": {"index": [0, 4, 5, 6], "modul": [0, 1], "search": 0, "page": 0, "setup": 1, "packag": [0, 1], "subpackag": 1, "data": [0, 1, 3, 6], "submodul": [0, 1, 3], "dataload": [0, 1, 3, 5, 6, 7], "datascal": [0, 1, 3, 6], "content": 1, "evalu": [0, 1, 3, 6], "model": [0, 1, 3, 5, 7], "ae": [0, 1, 3], "nde": [0, 1, 3], "nldm": [0, 1, 3, 5, 7, 8], "train": [0, 1, 3, 4, 6], "trainer": [0, 1, 3, 6], "util": [0, 1, 3], "addtyp": [0, 1, 3], "config": [0, 1, 3, 4, 5, 6, 7], "metric": [0, 1, 3, 5, 7], "nn": [0, 1, 3, 6], "op": [0, 1, 3], "plot": [0, 1, 3], "get_batch": [3, 4], "get_sampl": [3, 4], "get_scaler_paramet": [3, 4], "get_sect": [3, 4], "get_train_t0_indic": [3, 4], "get_trajectori": [3, 4], "summari": [3, 4, 6], "dataloaderconfig": [3, 4], "devic": [3, 4, 5, 6, 7, 8], "filepath": [3, 4], "reduced_dim": [3, 4], "scaler_typ": [3, 4], "time_subsampl": [3, 4], "time_validation_split": [3, 4], "scale_dataset": [3, 4], "scale_featur": [3, 4], "eval": [3, 5], "evaluatorconfig": [3, 5], "compile_mod": [3, 5, 7], "enable_amp": [3, 5, 6, 7], "enable_sc": [3, 5, 6], "enable_tf32": [3, 5, 7], "metrics_filenam": [3, 5, 7], "output_directori": [3, 5, 7], "sample_subtrajectori": [3, 5], "start_t_index": [3, 5], "timestep": [3, 4, 5, 6], "fielddecod": [3, 6], "forward": [3, 6, 8], "fieldencod": [3, 6], "statedecod": [3, 6], "stateencod": [3, 6], "neurald": [3, 6], "wrap_nvf": [3, 6], "neuralod": [3, 6], "neuralsd": [3, 6], "neuralvectorfield": [3, 6], "nldf": [3, 5, 6, 7], "get_batch_loss": [3, 6], "loss": [3, 6], "loss_criterion": [3, 6, 8], "postprocess": [3, 5, 6], "predict_trajectori": [3, 6], "preprocess": [3, 6], "nldfconfig": [3, 6], "np": [3, 4, 6], "ae_activ": [3, 6], "d": [3, 4, 6, 8], "decoder_architectur": [3, 6], "decoder_depth": [3, 6], "decoder_hidden_dim": [3, 6], "encoder_architectur": [3, 6], "encoder_depth": [3, 6], "encoder_hidden_dim": [3, 6], "latent_dim": [3, 6], "n": [3, 4, 5, 6, 8], "nde_activ": [3, 6], "nde_adjoint": [3, 6], "nde_depth": [3, 6], "nde_hidden_dim": [3, 6], "nde_integration_method": [3, 6], "nde_typ": [3, 6], "pod_lay": [3, 6], "add_pod_lay": [3, 6], "nldmbase": [3, 6, 7], "adjoint": [3, 6], "bidirect": [3, 6, 7], "latent_guid": [3, 6, 7], "load_model_from_checkpoint": [3, 6], "load_scaler_from_checkpoint": [3, 6], "load_scaler_from_dataset": [3, 6], "training_epoch": [3, 6], "validation_epoch": [3, 6], "nldmconfig": [3, 6], "nh": [3, 4, 6], "ae_conv_dim": [3, 6], "ae_residual_block": [3, 6], "decoder_conv_depth": [3, 6], "decoder_conv_hidden_channel": [3, 6], "decoder_mlp_state_hidden_dim": [3, 6], "decoder_reshape_dim": [3, 6], "encoder_conv_depth": [3, 6], "encoder_conv_hidden_channel": [3, 6], "encoder_mlp_param_depth": [3, 6], "encoder_mlp_param_hidden_dim": [3, 6], "encoder_mlp_state_hidden_dim": [3, 6], "encoder_mlp_time_depth": [3, 6], "encoder_mlp_time_hidden_dim": [3, 6], "encoder_param_emb": [3, 6], "encoder_reshape_dim": [3, 6], "state_channel": [3, 6], "trainerconfig": [3, 7], "batch_size_nod": [3, 4, 6, 7], "batch_size_param": [3, 4, 6, 7], "batch_size_timestep": [3, 4, 6, 7], "lambda_l2": [3, 7], "lr": [3, 7], "lr_schedul": [3, 7], "n_epoch": [3, 7], "optim": [3, 6, 7], "save_best_checkpoint": [3, 7], "save_checkpoints_freq": [3, 7], "valid": [3, 4, 6, 7], "warmup_lr": [3, 7], "warmup_n_epoch": [3, 7], "configbas": [3, 5, 6, 7, 8], "save": [3, 7, 8], "configjsonencod": [3, 8], "default": [3, 8], "metricslogg": [3, 8], "print_curr": [3, 8], "updat": [3, 8], "assert_dim_shap": [3, 8], "error": [3, 8], "relative_error": [3, 8], "relative_error_vector": [3, 8], "get_layers_s": [3, 8], "get_model_param": [3, 8], "model_summari": [3, 8], "activ": [3, 6, 8], "convblock": [3, 8], "convlay": [3, 8], "convresblock": [3, 8], "downsampl": [3, 8], "gaussianfouriermap": [3, 8], "hadamardlay": [3, 8], "hiddenopnet": [3, 8], "hiddensumlay": [3, 8], "hypernetwork": [3, 8], "set_hypernet_dim": [3, 8], "linear": [3, 8], "mlp": [3, 6, 8], "build_mlp": [3, 8], "init_param": [3, 8], "positionalencod": [3, 8], "pe_vmap": [3, 8], "reshadamardlay": [3, 8], "sine": [3, 8], "upsampl": [3, 8], "pod": [3, 6, 8], "delete_tensor": [3, 8], "get_meanstd": [3, 8], "get_minmax": [3, 8], "minmax_scal": [3, 8], "multiple_unsqueez": [3, 8], "set_se": [3, 8], "standard_scal": [3, 8], "time": [3, 4, 6, 8], "get_gridpoints_2d": [3, 8], "plot1": [3, 8], "plot3": [3, 8], "plot_evolut": [3, 8], "plot_evolution_error": [3, 8], "class": [4, 5, 6, 7, 8], "verbos": [4, 5, 7], "true": [4, 5, 6, 7, 8], "sourc": [4, 5, 6, 7, 8], "base": [4, 5, 6, 7, 8], "object": [4, 5, 6, 7, 8], "function": [6, 8], "descript": [], "return": [4, 6, 8], "batch": [4, 6, 7], "trajectori": [4, 6], "ut": [4, 6], "initi": [4, 6], "valu": [4, 6], "u0": [4, 6], "respect": 4, "paramet": [4, 6, 7], "instanc": [4, 6, 7, 8], "mut0_batch": 4, "t_batch": 4, "sampl": [4, 7], "from": [4, 5, 6], "snapshot": 4, "input": [6, 8], "tensor": [4, 6, 8], "": [4, 6, 8], "p": 4, "given": [4, 6, 8], "specif": 6, "size": [4, 6], "In": 4, "case": 4, "i": [4, 6, 8], "pass": [4, 6, 8], "output": [4, 5, 6, 7, 8], "field": [4, 6], "form": 4, "so": [4, 6, 8], "last": [4, 8], "dimens": [4, 6, 8], "state": [4, 6, 8], "instead": [4, 6, 8], "than": 4, "t0_index": [4, 6], "int": [4, 5, 6, 7, 8], "nt": [4, 6], "number": [4, 5, 6, 7, 8], "length": [4, 5, 6, 7], "m": [4, 6], "mesh": 4, "node": [4, 6, 7], "shape": [4, 6, 8], "batch_tim": [], "batch_siz": [4, 6], "mut0": [4, 6], "u": [4, 6, 8], "0": [4, 5, 7, 8], "x": [4, 6, 8], "coordin": [4, 6], "t": [4, 6, 8], "mut": [4, 6], "j": 4, "tupl": [4, 5, 6, 7, 8], "torch": [4, 5, 6, 7, 8], "return_typ": 4, "section_id": [4, 6], "str": [4, 5, 6, 7, 8], "complet": 4, "arg": [4, 5, 6, 7], "name": [4, 6], "dataset": [4, 5, 6, 7], "subsect": 4, "max_timestep": 4, "relat": 4, "shuffl": 4, "bool": [4, 5, 6, 7, 8], "fals": [4, 5, 6, 7, 8], "list": [4, 6, 8], "sequenc": [4, 5, 6], "param_index": [4, 6], "field_form": 4, "none": [4, 5, 6, 7, 8], "type": [4, 5, 6, 7], "cpu": [4, 5, 6, 7], "configur": [4, 5, 6, 7, 8], "featur": [4, 6, 8], "feature_typ": 4, "invers": [4, 6, 8], "intend": [5, 6, 7], "us": [5, 6, 7], "perform": [5, 6, 8], "test": 5, "loader": [5, 7], "20": [5, 8], "routin": [5, 6, 7], "predict": [5, 6], "subtrajectori": [5, 7], "which": [5, 6, 7], "start": [5, 7], "extract": 5, "subsampl": 5, "regular": [5, 7], "random": [5, 8], "flag": [4, 5, 6, 7], "enabl": [4, 5, 6, 7], "intern": [5, 6, 8], "pre": [5, 6, 8], "tensorfloat32": [5, 7], "precis": [5, 6, 7], "automat": [5, 6, 7], "mix": [5, 6, 7], "compil": [5, 7], "directori": [5, 7], "path": [5, 7, 8], "store": [5, 7], "filenam": [5, 7, 8], "depth": [6, 8], "3": [6, 8], "hidden_dim": [6, 8], "64": 6, "elu": [6, 8], "architectur": [6, 8], "hidden_sum": [6, 8], "decod": 6, "continuo": 6, "mu": [4, 6], "vector": [6, 8], "dim": [6, 8], "nmu": 6, "1": [4, 6, 8], "spatial": [6, 7, 8], "domain": 6, "latent": 6, "encod": [6, 8], "layer": [6, 8], "hidden": [6, 8], "z": 6, "defin": [6, 8], "comput": [6, 8], "everi": [6, 8], "call": [6, 8], "should": [6, 8], "overridden": [6, 8], "all": [6, 8], "subclass": [6, 8], "although": [6, 8], "recip": [6, 8], "need": [6, 7, 8], "within": [6, 8], "thi": [6, 8], "one": [6, 8], "afterward": [6, 8], "sinc": [6, 8], "former": [6, 8], "take": [6, 8], "care": [6, 8], "run": [6, 8], "regist": [6, 8], "hook": [6, 8], "while": [6, 8], "latter": [6, 8], "silent": [6, 8], "ignor": [6, 8], "them": [6, 8], "network": [6, 8], "conv_dim": 6, "conv_depth": 6, "out_channel": [6, 8], "hidden_channel": 6, "reshape_dim": 6, "residual_block": 6, "mlp_hidden_dim": 6, "t0": 6, "tf": 6, "high": 6, "dimension": [6, 8], "discret": 6, "uh": [4, 6], "consist": 6, "an": [4, 6, 8], "produc": 6, "intermedi": 6, "represent": 6, "reshap": 6, "process": 6, "feed": 6, "convolut": [6, 8], "possibli": 6, "equip": [6, 8], "residu": [6, 8], "connect": [6, 8], "emlpoi": 6, "1d": [4, 6], "2d": 6, "block": [6, 8], "channel": 6, "first": 6, "two": [6, 8], "skip": [6, 8], "ar": [4, 6, 7], "singl": [4, 6], "in_channel": [6, 8], "mlp_state_hidden_dim": 6, "256": 6, "param_emb": 6, "multipli": 6, "mlp_param_depth": 6, "2": [6, 8], "mlp_param_hidden_dim": 6, "mlp_time_depth": 6, "mlp_time_hidden_dim": 6, "embed": [6, 8], "For": [6, 8], "parameter": 6, "version": 6, "consid": 6, "pstateencod": 6, "specifi": [4, 6, 8], "when": 6, "appli": [6, 8], "conv2d": 6, "must": 6, "sqrt": 6, "abc": 6, "neural": 6, "differenti": 6, "equat": 6, "abstract": 6, "z0": 6, "integration_method": 6, "euler": 6, "f": [6, 8], "method": [5, 6, 7, 8], "wrap": 6, "ordinari": 6, "attribut": 6, "sigma": [6, 8], "stochast": 6, "implement": [6, 8], "ito": 6, "sde": 6, "diagon": 6, "nois": 6, "drift": 6, "diffus": 6, "It": [4, 6, 8], "implicit": 6, "depend": 6, "lead": [6, 8], "autonom": 6, "formul": 6, "continu": 6, "codomain": 6, "total": 6, "od": 6, "map": [6, 8], "zt": 6, "latent_nd": 6, "evolv": 6, "std": [6, 8], "numer": 6, "scheme": 6, "integr": 6, "http": [4, 6, 8], "arxiv": [6, 8], "org": [6, 8], "ab": [6, 8], "1806": 6, "07366": 6, "gpu": 6, "cuda": 6, "return_lat": 6, "ut_pr": [6, 8], "return_input": 6, "hadamard": [6, 8], "dynam": 6, "posit": [6, 8], "handl": 6, "project": 6, "provid": [6, 8], "argument": [4, 6], "transpos": 6, "ad": 6, "its": 6, "matrix": [6, 8], "infer": 6, "behavior": 6, "b": [6, 8], "concaten": 6, "pdegen": [4, 6], "scale": [4, 6, 8], "evolut": [6, 8], "nz": [], "note": [], "The": [], "indic": 4, "degre": 6, "freedom": 6, "involv": 6, "window": 6, "via": [4, 6, 8], "over": [4, 6], "basic": 6, "structur": [4, 6], "compos": 6, "common": 6, "layout": 6, "templat": [6, 8], "ensur": 6, "compat": 6, "back": 6, "t_0": 6, "t_f": 6, "those": 6, "avail": 6, "torchdiffeq": 6, "torchsd": 6, "where": [6, 8], "load": [4, 6], "properti": 6, "float": [6, 7, 8], "gener": [6, 8], "purpos": 6, "post": 6, "scaler": 6, "epoch_loss": 6, "checkpoint_path": 6, "checkpoint": [6, 7], "eventu": 6, "addit": 6, "info": [4, 6], "dict": 6, "print": [4, 6], "home": 6, "nicola": 6, "local": 6, "lib": 6, "python3": 6, "10": [6, 8], "site": 6, "__init__": 6, "py": 6, "epoch": [6, 7], "child": 6, "inherit": 6, "e": 6, "g": 6, "adam": [6, 7], "more": 6, "32": 6, "deriv": 7, "001": 7, "1e": 7, "05": 7, "differ": [7, 8], "popul": 7, "adadelta": 7, "adamax": 7, "rmsprop": 7, "sgd": 7, "learn": 7, "rate": 7, "schedul": 7, "decai": 7, "factor": 7, "exponentiallr": 7, "999": 7, "l2": 7, "warmup": 7, "dure": 7, "algorithm": [6, 7], "frequenc": 7, "configu": 8, "skipkei": 8, "ensure_ascii": 8, "check_circular": 8, "allow_nan": 8, "sort_kei": 8, "indent": 8, "separ": 8, "jsonencod": 8, "json": 8, "serial": 8, "obj": 8, "serializ": 8, "o": 8, "rais": 8, "typeerror": 8, "exampl": 8, "support": 8, "arbitrari": 8, "iter": 8, "you": 8, "could": 8, "like": 8, "def": 8, "self": 8, "try": 8, "except": 8, "els": 8, "let": 8, "metrics_kei": 8, "kei": 8, "metric_valu": 8, "return_dim": 8, "u_tru": 8, "u_pr": 8, "flatten_last": 8, "activation_id": 8, "kernel_s": 8, "stride": 8, "pad": 8, "A": 8, "stack": 8, "1512": 8, "03385": 8, "nonlinear": 8, "c": 8, "2n": 8, "3d": 8, "2w": 8, "2h": 8, "4d": 8, "w": 8, "h": 8, "averag": 8, "pool": 8, "input_dim": 8, "mapping_dim": 8, "gaussian": 8, "fourier": 8, "arrai": 8, "sin": 8, "pi": 8, "co": 8, "2006": 8, "10739": 8, "num_featur": 8, "y": 8, "cond_input_dim": 8, "output_dim": 8, "positional_encod": 8, "oper": 8, "condit": 8, "sum": [6, 8], "product": 8, "between": 8, "variabl": 8, "net": 8, "weight": 8, "1609": 8, "09106": 8, "in_featur": 8, "out_featur": 8, "bia": 8, "dtype": 8, "layers_dim": 8, "multi": 8, "perceptron": 8, "can": 8, "instanti": 8, "wai": 8, "By": 8, "hidden_dim_1": 8, "hidden_dim_n": 8, "string": 8, "If": 8, "have": 8, "same": 8, "enough": 8, "sequenti": 8, "l": 8, "nerf": 8, "2003": 8, "08934": 8, "transform": 8, "vmap": 8, "w0": 8, "30": 8, "sinusoid": 8, "siren": 8, "09661": 8, "nearest": 8, "neighbour": 8, "interpol": 8, "save_path": 8, "keep_last_dim": 8, "min": 8, "max": 8, "seed": 8, "mean": 8, "coord": 8, "titl": 8, "solut": 8, "figsiz": 8, "7": 8, "re": 8, "100": 8, "cmap": 8, "matplotlib": 8, "color": 8, "listedcolormap": 8, "fom": 8, "rel": 8, "5": 8, "ut_tru": 8, "scilimit": 8, "4": 8, "param": [4, 6], "bc": [], "sensit": 6, "guidanc": 6, "automodul": [], "member": [], "undoc": [], "show": [], "criterion": 6, "step": [4, 6], "de": 6, "order": 6, "emploi": 6, "upon": 6, "term": 6, "thu": 6, "combin": 6, "allow": 4, "manag": 4, "github": 4, "com": 4, "farenga": 4, "hdf5": 4, "file": 4, "compli": 4, "selector": 4, "along": 4, "th": 4, "st": 4, "section": 4, "creat": 4, "multipl": 4, "account": 4, "split": 4, "move": 4, "t_j": 4, "mu_i": 4, "whole": 4, "id": 4, "paramt": 4, "rescal": 4, "import": []}, "objects": {"": [[3, 0, 0, "-", "torchnldm"]], "torchnldm": [[4, 0, 0, "-", "data"], [5, 0, 0, "-", "evaluate"], [6, 0, 0, "-", "model"], [7, 0, 0, "-", "train"], [8, 0, 0, "-", "utils"]], "torchnldm.data": [[4, 0, 0, "-", "dataloader"], [4, 0, 0, "-", "datascaler"]], "torchnldm.data.dataloader": [[4, 1, 1, "", "DataLoader"], [4, 1, 1, "", "DataLoaderConfig"]], "torchnldm.data.dataloader.DataLoader": [[4, 2, 1, "", "get_batch"], [4, 2, 1, "", "get_sample"], [4, 2, 1, "", "get_scaler_parameters"], [4, 2, 1, "", "get_section"], [4, 2, 1, "", "get_train_t0_indices"], [4, 2, 1, "", "get_trajectory"], [4, 2, 1, "", "summary"], [4, 2, 1, "", "to"]], "torchnldm.data.dataloader.DataLoaderConfig": [[4, 3, 1, "", "device"], [4, 3, 1, "", "filepath"], [4, 3, 1, "", "reduced_dim"], [4, 3, 1, "", "scaler_type"], [4, 3, 1, "", "time_subsampling"], [4, 3, 1, "", "time_validation_split"]], "torchnldm.data.datascaler": [[4, 1, 1, "", "DataScaler"]], "torchnldm.data.datascaler.DataScaler": [[4, 2, 1, "", "scale_dataset"], [4, 2, 1, "", "scale_feature"]], "torchnldm.evaluate": [[5, 0, 0, "-", "evaluator"]], "torchnldm.evaluate.evaluator": [[5, 1, 1, "", "Evaluator"], [5, 1, 1, "", "EvaluatorConfig"]], "torchnldm.evaluate.evaluator.Evaluator": [[5, 2, 1, "", "eval"]], "torchnldm.evaluate.evaluator.EvaluatorConfig": [[5, 3, 1, "", "compile_mode"], [5, 3, 1, "", "device"], [5, 3, 1, "", "enable_amp"], [5, 3, 1, "", "enable_scaling"], [5, 3, 1, "", "enable_tf32"], [5, 3, 1, "", "metrics_filename"], [5, 3, 1, "", "output_directory"], [5, 3, 1, "", "sample_subtrajectories"], [5, 3, 1, "", "start_t_index"], [5, 3, 1, "", "timesteps"]], "torchnldm.model": [[6, 0, 0, "-", "ae"], [6, 0, 0, "-", "nde"], [6, 0, 0, "-", "nldm"]], "torchnldm.model.ae": [[6, 1, 1, "", "FieldDecoder"], [6, 1, 1, "", "FieldEncoder"], [6, 1, 1, "", "StateDecoder"], [6, 1, 1, "", "StateEncoder"]], "torchnldm.model.ae.FieldDecoder": [[6, 2, 1, "", "forward"]], "torchnldm.model.ae.FieldEncoder": [[6, 2, 1, "", "forward"]], "torchnldm.model.ae.StateDecoder": [[6, 2, 1, "", "forward"]], "torchnldm.model.ae.StateEncoder": [[6, 2, 1, "", "forward"]], "torchnldm.model.nde": [[6, 1, 1, "", "NeuralDE"], [6, 1, 1, "", "NeuralODE"], [6, 1, 1, "", "NeuralSDE"], [6, 1, 1, "", "NeuralVectorField"]], "torchnldm.model.nde.NeuralDE": [[6, 2, 1, "", "forward"], [6, 2, 1, "", "wrap_nvf"]], "torchnldm.model.nde.NeuralODE": [[6, 2, 1, "", "forward"]], "torchnldm.model.nde.NeuralSDE": [[6, 2, 1, "", "forward"]], "torchnldm.model.nde.NeuralVectorField": [[6, 2, 1, "", "forward"]], "torchnldm.model.nldm": [[6, 1, 1, "", "NLDF"], [6, 1, 1, "", "NLDFConfig"], [6, 1, 1, "", "NLDM"], [6, 1, 1, "", "NLDMBase"], [6, 1, 1, "", "NLDMConfig"]], "torchnldm.model.nldm.NLDF": [[6, 2, 1, "", "forward"], [6, 2, 1, "", "get_batch_loss"], [6, 2, 1, "", "loss"], [6, 2, 1, "", "loss_criterion"], [6, 2, 1, "", "postprocess"], [6, 2, 1, "", "predict_trajectory"], [6, 2, 1, "", "preprocess"]], "torchnldm.model.nldm.NLDFConfig": [[6, 3, 1, "", "Np"], [6, 3, 1, "", "ae_activation"], [6, 3, 1, "", "d"], [6, 3, 1, "", "decoder_architecture"], [6, 3, 1, "", "decoder_depth"], [6, 3, 1, "", "decoder_hidden_dim"], [6, 3, 1, "", "device"], [6, 3, 1, "", "encoder_architecture"], [6, 3, 1, "", "encoder_depth"], [6, 3, 1, "", "encoder_hidden_dim"], [6, 3, 1, "", "latent_dim"], [6, 3, 1, "", "n"], [6, 3, 1, "", "nde_activation"], [6, 3, 1, "", "nde_adjoint"], [6, 3, 1, "", "nde_depth"], [6, 3, 1, "", "nde_hidden_dim"], [6, 3, 1, "", "nde_integration_method"], [6, 3, 1, "", "nde_type"]], "torchnldm.model.nldm.NLDM": [[6, 2, 1, "", "POD_layer"], [6, 2, 1, "", "add_POD_layer"], [6, 2, 1, "", "forward"], [6, 2, 1, "", "get_batch_loss"], [6, 2, 1, "", "loss"], [6, 2, 1, "", "loss_criterion"], [6, 2, 1, "", "postprocess"], [6, 2, 1, "", "predict_trajectory"], [6, 2, 1, "", "preprocess"]], "torchnldm.model.nldm.NLDMBase": [[6, 4, 1, "", "adjoint"], [6, 4, 1, "", "bidirectional"], [6, 2, 1, "", "evaluate"], [6, 2, 1, "", "forward"], [6, 2, 1, "", "get_batch_loss"], [6, 4, 1, "", "latent_guidance"], [6, 2, 1, "", "load_model_from_checkpoint"], [6, 2, 1, "", "load_scaler_from_checkpoint"], [6, 2, 1, "", "load_scaler_from_dataset"], [6, 2, 1, "", "loss"], [6, 2, 1, "", "loss_criterion"], [6, 4, 1, "", "nde_adjoint"], [6, 4, 1, "", "nde_integration_method"], [6, 2, 1, "", "predict_trajectory"], [6, 2, 1, "", "summary"], [6, 2, 1, "", "training_epoch"], [6, 2, 1, "", "validation_epoch"]], "torchnldm.model.nldm.NLDMConfig": [[6, 3, 1, "", "Nh"], [6, 3, 1, "", "Np"], [6, 3, 1, "", "ae_activation"], [6, 3, 1, "", "ae_conv_dim"], [6, 3, 1, "", "ae_residual_blocks"], [6, 3, 1, "", "decoder_conv_depth"], [6, 3, 1, "", "decoder_conv_hidden_channels"], [6, 3, 1, "", "decoder_mlp_state_hidden_dim"], [6, 3, 1, "", "decoder_reshape_dim"], [6, 3, 1, "", "device"], [6, 3, 1, "", "encoder_conv_depth"], [6, 3, 1, "", "encoder_conv_hidden_channels"], [6, 3, 1, "", "encoder_mlp_param_depth"], [6, 3, 1, "", "encoder_mlp_param_hidden_dim"], [6, 3, 1, "", "encoder_mlp_state_hidden_dim"], [6, 3, 1, "", "encoder_mlp_time_depth"], [6, 3, 1, "", "encoder_mlp_time_hidden_dim"], [6, 3, 1, "", "encoder_param_emb"], [6, 3, 1, "", "encoder_reshape_dim"], [6, 3, 1, "", "latent_dim"], [6, 3, 1, "", "nde_activation"], [6, 3, 1, "", "nde_adjoint"], [6, 3, 1, "", "nde_depth"], [6, 3, 1, "", "nde_hidden_dim"], [6, 3, 1, "", "nde_integration_method"], [6, 3, 1, "", "nde_type"], [6, 3, 1, "", "state_channels"]], "torchnldm.train": [[7, 0, 0, "-", "trainer"]], "torchnldm.train.trainer": [[7, 1, 1, "", "Trainer"], [7, 1, 1, "", "TrainerConfig"]], "torchnldm.train.trainer.Trainer": [[7, 2, 1, "", "train"]], "torchnldm.train.trainer.TrainerConfig": [[7, 3, 1, "", "batch_size_nodes"], [7, 3, 1, "", "batch_size_params"], [7, 3, 1, "", "batch_size_timesteps"], [7, 3, 1, "", "bidirectional"], [7, 3, 1, "", "compile_mode"], [7, 3, 1, "", "device"], [7, 3, 1, "", "enable_amp"], [7, 3, 1, "", "enable_tf32"], [7, 3, 1, "", "lambda_l2"], [7, 3, 1, "", "latent_guidance"], [7, 3, 1, "", "lr"], [7, 3, 1, "", "lr_scheduler"], [7, 3, 1, "", "metrics_filename"], [7, 3, 1, "", "n_epochs"], [7, 3, 1, "", "optimizer"], [7, 3, 1, "", "output_directory"], [7, 3, 1, "", "save_best_checkpoints"], [7, 3, 1, "", "save_checkpoints_freq"], [7, 3, 1, "", "validation"], [7, 3, 1, "", "warmup_lr"], [7, 3, 1, "", "warmup_n_epochs"]], "torchnldm.utils": [[8, 0, 0, "-", "addtypes"], [8, 0, 0, "-", "config"], [8, 0, 0, "-", "metrics"], [8, 0, 0, "-", "model"], [8, 0, 0, "-", "nn"], [8, 0, 0, "-", "ops"], [8, 0, 0, "-", "plot"]], "torchnldm.utils.config": [[8, 1, 1, "", "ConfigBase"], [8, 1, 1, "", "ConfigJSONEncoder"]], "torchnldm.utils.config.ConfigBase": [[8, 2, 1, "", "save"]], "torchnldm.utils.config.ConfigJSONEncoder": [[8, 2, 1, "", "default"]], "torchnldm.utils.metrics": [[8, 1, 1, "", "MetricsLogger"], [8, 5, 1, "", "assert_dim_shape"], [8, 5, 1, "", "error"], [8, 5, 1, "", "loss_criterion"], [8, 5, 1, "", "relative_error"], [8, 5, 1, "", "relative_error_vectorized"]], "torchnldm.utils.metrics.MetricsLogger": [[8, 2, 1, "", "print_current"], [8, 2, 1, "", "save"], [8, 2, 1, "", "update"]], "torchnldm.utils.model": [[8, 5, 1, "", "get_layers_sizes"], [8, 5, 1, "", "get_model_params"], [8, 5, 1, "", "model_summary"]], "torchnldm.utils.nn": [[8, 1, 1, "", "Activation"], [8, 1, 1, "", "ConvBlock"], [8, 1, 1, "", "ConvLayer"], [8, 1, 1, "", "ConvResBlock"], [8, 1, 1, "", "Downsample"], [8, 1, 1, "", "GaussianFourierMap"], [8, 1, 1, "", "HadamardLayer"], [8, 1, 1, "", "HiddenOpNet"], [8, 1, 1, "", "HiddenSumLayer"], [8, 1, 1, "", "Hypernetwork"], [8, 1, 1, "", "Linear"], [8, 1, 1, "", "MLP"], [8, 1, 1, "", "PositionalEncoding"], [8, 1, 1, "", "ResHadamardLayer"], [8, 1, 1, "", "Sine"], [8, 1, 1, "", "Upsample"]], "torchnldm.utils.nn.Activation": [[8, 2, 1, "", "forward"]], "torchnldm.utils.nn.ConvBlock": [[8, 2, 1, "", "forward"]], "torchnldm.utils.nn.ConvLayer": [[8, 2, 1, "", "forward"]], "torchnldm.utils.nn.ConvResBlock": [[8, 2, 1, "", "forward"]], "torchnldm.utils.nn.Downsample": [[8, 2, 1, "", "forward"]], "torchnldm.utils.nn.GaussianFourierMap": [[8, 2, 1, "", "forward"]], "torchnldm.utils.nn.HadamardLayer": [[8, 2, 1, "", "forward"]], "torchnldm.utils.nn.HiddenOpNet": [[8, 2, 1, "", "forward"]], "torchnldm.utils.nn.HiddenSumLayer": [[8, 2, 1, "", "forward"]], "torchnldm.utils.nn.Hypernetwork": [[8, 2, 1, "", "forward"], [8, 2, 1, "", "set_hypernet_dims"]], "torchnldm.utils.nn.Linear": [[8, 2, 1, "", "forward"]], "torchnldm.utils.nn.MLP": [[8, 2, 1, "", "build_mlp"], [8, 2, 1, "", "forward"], [8, 2, 1, "", "init_params"]], "torchnldm.utils.nn.PositionalEncoding": [[8, 2, 1, "", "forward"], [8, 2, 1, "", "pe_vmap"]], "torchnldm.utils.nn.ResHadamardLayer": [[8, 2, 1, "", "forward"]], "torchnldm.utils.nn.Sine": [[8, 2, 1, "", "forward"]], "torchnldm.utils.nn.Upsample": [[8, 2, 1, "", "forward"]], "torchnldm.utils.ops": [[8, 5, 1, "", "POD"], [8, 5, 1, "", "delete_tensor"], [8, 5, 1, "", "get_meanstd"], [8, 5, 1, "", "get_minmax"], [8, 5, 1, "", "minmax_scaler"], [8, 5, 1, "", "multiple_unsqueeze"], [8, 5, 1, "", "set_seed"], [8, 5, 1, "", "standard_scaler"], [8, 5, 1, "", "timing"]], "torchnldm.utils.plot": [[8, 5, 1, "", "get_gridpoints_2d"], [8, 5, 1, "", "plot1"], [8, 5, 1, "", "plot3"], [8, 5, 1, "", "plot_evolution"], [8, 5, 1, "", "plot_evolution_error"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method", "3": "py:attribute", "4": "py:property", "5": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"], "3": ["py", "attribute", "Python attribute"], "4": ["py", "property", "Python property"], "5": ["py", "function", "Python function"]}, "titleterms": {"welcom": [], "torchnldm": [0, 1, 3, 4, 5, 6, 7, 8], "": [], "document": 0, "indic": 0, "tabl": 0, "setup": 2, "modul": [2, 3, 4, 5, 6, 7, 8], "packag": [3, 4, 5, 6, 7, 8], "subpackag": 3, "content": [0, 3, 4, 5, 6, 7, 8], "data": 4, "submodul": [4, 5, 6, 7, 8], "dataload": 4, "datascal": 4, "evalu": 5, "model": [6, 8], "ae": 6, "nde": 6, "nldm": 6, "train": 7, "trainer": 7, "util": 8, "addtyp": 8, "config": 8, "metric": 8, "nn": 8, "op": 8, "plot": 8}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.todo": 2, "sphinx.ext.viewcode": 1, "sphinx": 57}, "alltitles": {"torchnldm": [[1, "torchnldm"]], "torchnldm package": [[3, "torchnldm-package"]], "Subpackages": [[3, "subpackages"]], "Module contents": [[3, "module-torchnldm"], [8, "module-torchnldm.utils"], [4, "module-torchnldm.data"], [6, "module-torchnldm.model"], [7, "module-torchnldm.train"], [5, "module-torchnldm.evaluate"]], "Submodules": [[8, "submodules"], [4, "submodules"], [6, "submodules"], [7, "submodules"], [5, "submodules"]], "torchnldm.utils package": [[8, "torchnldm-utils-package"]], "torchnldm.utils.addtypes module": [[8, "module-torchnldm.utils.addtypes"]], "torchnldm.utils.config module": [[8, "module-torchnldm.utils.config"]], "torchnldm.utils.metrics module": [[8, "module-torchnldm.utils.metrics"]], "torchnldm.utils.model module": [[8, "module-torchnldm.utils.model"]], "torchnldm.utils.nn module": [[8, "module-torchnldm.utils.nn"]], "torchnldm.utils.ops module": [[8, "module-torchnldm.utils.ops"]], "torchnldm.utils.plot module": [[8, "module-torchnldm.utils.plot"]], "torchnldm.data package": [[4, "torchnldm-data-package"]], "torchnldm.data.dataloader module": [[4, "module-torchnldm.data.dataloader"]], "torchnldm.data.datascaler module": [[4, "module-torchnldm.data.datascaler"]], "torchnldm.model package": [[6, "torchnldm-model-package"]], "torchnldm.model.ae module": [[6, "module-torchnldm.model.ae"]], "torchnldm.model.nde module": [[6, "module-torchnldm.model.nde"]], "torchnldm.model.nldm module": [[6, "module-torchnldm.model.nldm"]], "torchnldm.train package": [[7, "torchnldm-train-package"]], "torchnldm.train.trainer module": [[7, "module-torchnldm.train.trainer"]], "TorchNLDM documentation": [[0, "torchnldm-documentation"]], "Contents:": [[0, null]], "Indices and tables": [[0, "indices-and-tables"]], "setup module": [[2, "setup-module"]], "torchnldm.evaluate package": [[5, "torchnldm-evaluate-package"]], "torchnldm.evaluate.evaluator module": [[5, "module-torchnldm.evaluate.evaluator"]]}, "indexentries": {"module": [[3, "module-torchnldm"], [5, "module-torchnldm.evaluate"], [5, "module-torchnldm.evaluate.evaluator"]], "torchnldm": [[3, "module-torchnldm"]], "evaluator (class in torchnldm.evaluate.evaluator)": [[5, "torchnldm.evaluate.evaluator.Evaluator"]], "evaluatorconfig (class in torchnldm.evaluate.evaluator)": [[5, "torchnldm.evaluate.evaluator.EvaluatorConfig"]], "compile_mode (torchnldm.evaluate.evaluator.evaluatorconfig attribute)": [[5, "torchnldm.evaluate.evaluator.EvaluatorConfig.compile_mode"]], "device (torchnldm.evaluate.evaluator.evaluatorconfig attribute)": [[5, "torchnldm.evaluate.evaluator.EvaluatorConfig.device"]], "enable_amp (torchnldm.evaluate.evaluator.evaluatorconfig attribute)": [[5, "torchnldm.evaluate.evaluator.EvaluatorConfig.enable_amp"]], "enable_scaling (torchnldm.evaluate.evaluator.evaluatorconfig attribute)": [[5, "torchnldm.evaluate.evaluator.EvaluatorConfig.enable_scaling"]], "enable_tf32 (torchnldm.evaluate.evaluator.evaluatorconfig attribute)": [[5, "torchnldm.evaluate.evaluator.EvaluatorConfig.enable_tf32"]], "eval() (torchnldm.evaluate.evaluator.evaluator method)": [[5, "torchnldm.evaluate.evaluator.Evaluator.eval"]], "metrics_filename (torchnldm.evaluate.evaluator.evaluatorconfig attribute)": [[5, "torchnldm.evaluate.evaluator.EvaluatorConfig.metrics_filename"]], "output_directory (torchnldm.evaluate.evaluator.evaluatorconfig attribute)": [[5, "torchnldm.evaluate.evaluator.EvaluatorConfig.output_directory"]], "sample_subtrajectories (torchnldm.evaluate.evaluator.evaluatorconfig attribute)": [[5, "torchnldm.evaluate.evaluator.EvaluatorConfig.sample_subtrajectories"]], "start_t_index (torchnldm.evaluate.evaluator.evaluatorconfig attribute)": [[5, "torchnldm.evaluate.evaluator.EvaluatorConfig.start_t_index"]], "timesteps (torchnldm.evaluate.evaluator.evaluatorconfig attribute)": [[5, "torchnldm.evaluate.evaluator.EvaluatorConfig.timesteps"]], "torchnldm.evaluate": [[5, "module-torchnldm.evaluate"]], "torchnldm.evaluate.evaluator": [[5, "module-torchnldm.evaluate.evaluator"]]}})